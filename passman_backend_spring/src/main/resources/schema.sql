create TABLE IF NOT EXISTS "USERS" (
   id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
   master_password_hash VARCHAR(255),
   username VARCHAR(255) NOT NULL,
   encoded_password VARCHAR(255) NOT NULL,
   CONSTRAINT pk_users PRIMARY KEY (id),
   CONSTRAINT uc_users_username UNIQUE (username)
);

create TABLE IF NOT EXISTS "DERIVED_USER_KEYS" (
  id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
  derived_key VARCHAR(255) NOT NULL,
  derived_key_name VARCHAR(255),
  user_id BIGINT NOT NULL,
  CONSTRAINT pk_deriveduserkey PRIMARY KEY (id),
  CONSTRAINT uc_deriveduserkey_derived_key_name UNIQUE (derived_key_name),
  CONSTRAINT FK_DERIVEDUSERKEY_ON_USER FOREIGN KEY (user_id) REFERENCES "USERS" (id)
);

create TABLE IF NOT EXISTS "RECOVERY_DATA" (
  id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
   user_id BIGINT NOT NULL,
   recovery_key VARCHAR(255),
   CONSTRAINT pk_recoverydata PRIMARY KEY (id),
   CONSTRAINT FK_RECOVERYDATA_ON_USER FOREIGN KEY (user_id) REFERENCES "USERS" (id)
);

CREATE TABLE IF NOT EXISTS "USERS_JWT" (
  id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
   user_id BIGINT,
   jwt VARCHAR(255),
   CONSTRAINT pk_users_jwt PRIMARY KEY (id),
   CONSTRAINT FK_USERS_JWT_ON_USER FOREIGN KEY (user_id) REFERENCES "USERS" (id)
);